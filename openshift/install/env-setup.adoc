= 软件包安装和环境准备
:toc: manual
:toc-placement: preamble

本部分包括软件包安装和环境准备等相关的配置。

== 安装相关软件包

[source, bash]
.*在 master, node1, node2 上执行*
----
yum -y install wget git net-tools bind-utils iptables-services bridge-utils bash-completion vim lrzsz unzip;
yum -y update;
yum -y install atomic-openshift-utils;
----

[source, bash]
.*yum/git/registry 上安装*
----
yum -y install wget git net-tools bind-utils bridge-utils bash-completion vim lrzsz unzip;
yum -y update;
----

== Docker 的安装及配置

[source, bash]
.*在所有机器上安装 docker*
----
yum -y install docker;
systemctl enable docker;
systemctl start docker
----

[source, bash]
.*配置 docker*
----
cp /etc/sysconfig/docker /etc/sysconfig/docker.bak.$(date "+%Y%m%d%H%M%S");
sed -i s/".*OPTIONS=.*"/"OPTIONS='--selinux-enabled --insecure-registry 172.30.0.0\/16 --insecure-registry registry.example.com:5000'"/g /etc/sysconfig/docker;
sed -i 's/registry.access.redhat.com/registry.example.com:5000/g' /etc/sysconfig/docker;
systemctl restart docker
----


== 所有节点(master, node1, node2, yum, registry, nfs, git)停止并禁用防火墙

在所有机器上操作如下命令停止并禁用防火墙：

[source, bash]
----
systemctl stop firewalld
systemctl disable firewalld
----

== 所有节点(master, node1, node2, yum, registry, nfs, git)开启selinux

在所有机器上配置确认 SELinux 为 Enforcing 状态。

[source, text]
----
# getenforce 
Enforcing
----

== iptables 配置

[source, text]
.*yum/registry/git/nfs 上执行*
----
iptables -I INPUT -p tcp -m tcp --dport 5000 -j ACCEPT
----
