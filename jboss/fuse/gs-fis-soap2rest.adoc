= SOAP To Rest
:toc: manual
:toc-placement: preamble

This demo if for demonstrating how to convert a exist SOAP Service to Rest Service as below:

image:files/fis-soap2rest.png[FSI SOAP2REST]

The SOAP Service recieve SOAP Request with cuntry name, the SOAP response will reponse the whole conuntry information, once the SOAP service be convert to rest, the Rest Post method recieve a simple json with cuntry name, the REST return the completed country json.

== Run with Spring Boot

[source, bash]
----
$ cd fuse-get-started/fis-soap2rest
$ mvn clean package
$ java -jar target/fis-soaptorest-1.0.0-SNAPSHOT.jar
----

Use the following URL to test the new wrapped rest:

[source, bash]
----
$ curl -X GET  http://localhost:10000/rest/ping
Success!
$ curl -X POST  http://localhost:10000/rest/getCountry -H 'cache-control: no-cache' -H 'content-type: application/json' -d '{"name":"China"}'
{"country":{"name":"China","population":136704314,"capital":"Beijing","currency":"RMB"}}
----

== Run with OpenShift

[source, bash]
----
oc new-project test --display-name="Test Project" --description="Test Project"
mvn -Dkubernetes.master=https://192.168.42.107:8443 -Dkubernetes.namespace=test -Dkubernetes.auth.basic.username=developer -Dkubernetes.auth.basic.password=developer -Dfabric8.mode=openshift -Dkubernetes.trust.certificates=true -Dfabric8.build.strategy=s2i -Dkubernetes.auth.tryServiceAccount=false -Dfabric8.generator.from=registry.access.redhat.com/jboss-fuse-6/fis-java-openshift -Dfabric8.generator.fromMode=docker -Dkubernetes.auth.tryKubeConfig=false clean fabric8:deploy
oc expose svc/fis-soaptorest
----

Use the following URL to test the new wrapped rest:

[source, bash]
----
$ curl -X GET  http://fis-soaptorest-test.192.168.42.107.nip.io/rest/ping
Success!
$ curl -X POST  http://fis-soaptorest-test.192.168.42.107.nip.io/rest/getCountry -H 'cache-control: no-cache' -H 'content-type: application/json' -d '{"name":"China"}'
{"country":{"name":"China","population":136704314,"capital":"Beijing","currency":"RMB"}}
----

NOTE: DONOT forget to change the port mapping to make sure above test work success.
